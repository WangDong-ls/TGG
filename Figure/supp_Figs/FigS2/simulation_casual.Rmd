### simulation

```{r}
library(ggplot2)
library(ggsci)
data <- read.table("./diff_same_kinship_sim.txt",header = T,sep="\t")
#colnames(data) <- c("Name","Marker","exp_h2","QTN","rep","Sim","Model","Type","h2","pSNPs","pSVs")d
data$QTN <- factor(data$QTN,levels=c(10,100,500,1000))

g_ticks <- seq(0.15,0.9,0.15)

#snps <- data[data$Type=="SNPs",]

p1 <- ggplot(data,aes(x=h2_simulated,y=h2_estimated,group=QTN))+
  geom_point(aes(color=QTN),size=0.5)+
  #geom_segment(aes(x=h2_estimated-se,xend=h2_estimated+se,y=h2_estimated,yend=h2_estimated,color=QTN,group=QTN))+
  #geom_line(aes(color=QTN))+
  facet_wrap(~type,nrow = 2)+
  geom_abline(slope=1,linetype="dashed",size=0.3)+
  scale_x_continuous(breaks = g_ticks)+
  scale_y_continuous(breaks = g_ticks)+
  labs(x="h2 (simuatated)",y="h2 (Estimated)")+
  theme_bw()+
  theme(
    axis.text=element_text(size=6,color="black"),
    axis.title=element_text(size=6,color="black"),
    axis.line = element_line(size=0.3),
    axis.ticks = element_line(size=0.3),
    legend.position = "top",
    legend.text = element_text(size=6,color="black"),
    legend.title = element_text(size=6,color="black")
  )+
  scale_color_npg()
p1

  
ggsave("simulation1.pdf",p1,width=12,height = 12,units="cm")
```